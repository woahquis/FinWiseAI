# FinWise AI ‚Äî Supabase Webhook Build

### What‚Äôs inside
- `index.html` ‚Äî PayPal Smart Buttons (LIVE) + redirect to `thank-you.html`
- `thank-you.html` ‚Äî shows order details
- `/api/paypal-webhook.js` ‚Äî verifies PayPal signature, inserts orders to **Supabase**
- `/api/orders-list.js` ‚Äî admin listing (secured by `ADMIN_LIST_TOKEN`)
- `/api/order-log.js` ‚Äî optional client log
- `supabase_schema.sql` ‚Äî run in Supabase SQL editor to create the table
- `CNAME`, `robots.txt`, `sitemap.xml`, `favicon.png`

### Environment Variables (Vercel ‚Üí Project ‚Üí Settings ‚Üí Environment Variables)
- `PAYPAL_CLIENT_ID`
- `PAYPAL_CLIENT_SECRET`
- `PAYPAL_WEBHOOK_ID`
- `SUPABASE_URL`
- `SUPABASE_SERVICE_ROLE_KEY`  ‚Üê **server-only**
- `ADMIN_LIST_TOKEN`           ‚Üê random secret for admin list

### Deploy
1. Push to GitHub ‚Üí Import to **Vercel**.
2. Add env vars above; deploy.
3. In PayPal Dashboard ‚Üí **Webhooks**, use:
   `https://<your-app>.vercel.app/api/paypal-webhook`
4. Test with **Send test webhook** (expect 200).

### Fetch orders (admin)
`GET https://<your-app>.vercel.app/api/orders-list?token=YOUR_ADMIN_LIST_TOKEN`


## üîó Digital Delivery (this build)
- Edit **downloads.json** with your real download URLs for each product name.
- The Thank You page auto-matches the buyer‚Äôs item to the correct link and shows a **Download** button.
- Tip: Use Google Drive direct links (`uc?export=download&id=...`) or Gumroad/Lemon Squeezy download URLs.

### ‚ö†Ô∏è Security notes
- Static links can be shared. For better protection, consider:
  - Expiring pre-signed links (S3/Cloudflare R2) generated by your webhook, then emailed to the buyer.
  - Store orders in Supabase and serve a one-time token download endpoint.
  - Always keep the **Service Role Key** server-only.


## üîê Admin page
Open **/admin.html** and enter your `ADMIN_LIST_TOKEN` to load the latest 200 orders.
- Click **Download CSV** to export.
- The token is stored in `localStorage` on your device for convenience; click **Clear** to remove it.
- Ensure the environment variable `ADMIN_LIST_TOKEN` is set in Vercel and matches the token you enter.
